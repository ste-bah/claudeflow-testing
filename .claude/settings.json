{
  "env": {
    "CLAUDE_FLOW_AUTO_COMMIT": "false",
    "CLAUDE_FLOW_AUTO_PUSH": "false",
    "CLAUDE_FLOW_HOOKS_ENABLED": "true",
    "CLAUDE_FLOW_TELEMETRY_ENABLED": "true",
    "CLAUDE_FLOW_REMOTE_EXECUTION": "true",
    "CLAUDE_FLOW_CHECKPOINTS_ENABLED": "true"
  },
  "permissions": {
    "allow": [
      "Bash(npx tsx:*)",
      "Bash(npx claude-flow:*)",
      "Bash(npx claude-flow@alpha:*)",
      "Bash(cd:*)",
      "Bash(wc:*)",
      "Bash(npx vitest:*)",
      "Bash(npx tsc:*)",
      "Bash(sleep:*)",
      "Bash(python3:*)",
      "Bash(python:*)",
      "Bash(python -m pytest:*)",
      "Bash(kill:*)",
      "Bash(tail:*)",
      "Bash(head:*)",
      "Bash(test:*)",
      "Bash(npm run lint)",
      "Bash(npm run test:*)",
      "Bash(npm test:*)",
      "Bash(npm run memory:*)",
      "Bash(npm run daemon:*)",
      "Bash(npm run ucm:*)",
      "Bash(npm run observe:*)",
      "Bash(git status)",
      "Bash(git diff:*)",
      "Bash(git log:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push)",
      "Bash(git config:*)",
      "Bash(git tag:*)",
      "Bash(git branch:*)",
      "Bash(git checkout:*)",
      "Bash(git stash:*)",
      "Bash(jq:*)",
      "Bash(node:*)",
      "Bash(cat > /tmp/:*)",
      "Bash(cat>/tmp/:*)",
      "Bash(cat:*)",
      "Write(/tmp/**)",
      "Write(/Volumes/Externalwork/projects/claudeflow-testing/tmp/**)",
      "Bash(which:*)",
      "Bash(pwd)",
      "Bash(ls:*)",
      "Bash(grep:*)",
      "Bash(sed:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts status)",
      "Bash(npx tsx src/god-agent/universal/cli.ts ask:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts code:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts research:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts write:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts learn:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts query:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts feedback:*)",
      "Bash(npx tsx src/god-agent/universal/cli.ts help:*)",
      "Bash(timeout 10 npx tsx src/god-agent/universal/cli.ts:*)",
      "mcp__serena__find_symbol",
      "mcp__serena__list_dir",
      "mcp__serena__get_symbols_overview",
      "mcp__serena__search_for_pattern",
      "mcp__serena__read_file",
      "mcp__serena__find_referencing_symbols",
      "mcp__serena__find_file",
      "mcp__serena__list_memories",
      "mcp__serena__read_memory",
      "mcp__serena__get_current_config",
      "mcp__serena__check_onboarding_performed",
      "mcp__serena__replace_regex",
      "mcp__serena__insert_after_symbol",
      "mcp__serena__insert_before_symbol",
      "mcp__serena__replace_symbol_body",
      "mcp__serena__write_memory"
    ],
    "deny": [
      "Bash(rm -rf /)"
    ],
    "additionalDirectories": [
      "/tmp"
    ]
  },
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Skill",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; SKILL=$(cat | jq -r \".tool_input.skill // empty\"); if [ \"$SKILL\" = \"god-code\" ] && [ -f \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" ]; then source \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" && activate_pipeline; elif [ \"$SKILL\" = \"god-code\" ]; then echo \"0\" > \"$ROOT/.claude/runtime/.god-code-active\"; echo \"ðŸ”’ GOD-CODE PIPELINE MODE ACTIVATED - Direct Write/Edit blocked until Task agents spawned\"; fi; [ -x \"$ROOT/.claude/hooks/coding-pipeline-pre.sh\" ] && \"$ROOT/.claude/hooks/coding-pipeline-pre.sh\" || true'"
          }
        ]
      },
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null); if [ -n \"$ROOT\" ] && [ -f \"$ROOT/.claude/runtime/.god-code-active\" ]; then if [ -f \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" ]; then source \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" && increment_agent_count; else COUNT=$(cat \"$ROOT/.claude/runtime/.god-code-active\" 2>/dev/null || echo 0); echo $((COUNT + 1)) > \"$ROOT/.claude/runtime/.god-code-active\"; echo \"ðŸ“Š Pipeline Task #$((COUNT + 1)) spawned\"; fi; fi; [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/pre-task.sh\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; \"$ROOT/.claude/hooks/pre-task.sh\" || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -f \"$ROOT/scripts/hooks/ucm-desc-injector.ts\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; npx tsx \"$ROOT/scripts/hooks/ucm-desc-injector.ts\" || true'"
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/block-heredoc.sh\" ] && \"$ROOT/.claude/hooks/block-heredoc.sh\" || echo \"{\\\"decision\\\": \\\"allow\\\"}\"'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; cat | jq -r \".tool_input.command // empty\" | tr \"\\n\" \"\\0\" | xargs -0 -I {} npx claude-flow@alpha hooks pre-command --command \"{}\" --validate-safety true --prepare-resources true || true'"
          }
        ]
      },
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; if [ -f \"$ROOT/.claude/runtime/.god-code-active\" ]; then if [ -f \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" ]; then FILE_PATH=$(cat | jq -r \".tool_input.file_path // .tool_input.path // empty\"); TOOL_NAME=$(cat | jq -r \".tool_name // empty\"); source \"$ROOT/.claude/hooks/god-code-enforcement-v2.sh\" && check_write_permission \"$TOOL_NAME\" \"$FILE_PATH\"; else TASK_COUNT=$(cat \"$ROOT/.claude/runtime/.god-code-active\" 2>/dev/null || echo 0); if [ \"$TASK_COUNT\" -lt 7 ]; then echo \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"; echo \"ðŸš« BLOCKED: /god-code Pipeline Violation\"; echo \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"; echo \"You tried to use Write/Edit directly.\"; echo \"Task agents spawned: $TASK_COUNT (minimum required: 7)\"; echo \"\"; echo \"REQUIRED: Use Task(\\\"task-analyzer\\\", ...) first!\"; echo \"Pipeline must reach Phase 4 before writing files.\"; echo \"â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\"; exit 1; fi; fi; fi; cat | jq -r \".tool_input.file_path // .tool_input.path // empty\" | tr \"\\n\" \"\\0\" | xargs -0 -I {} npx claude-flow@alpha hooks pre-edit --file \"{}\" --auto-assign-agents true --load-context true || true'"
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Skill",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; SKILL=$(cat | jq -r \".tool_input.skill // empty\"); if [ \"$SKILL\" = \"god-code\" ] && [ -x \"$ROOT/.claude/hooks/coding-pipeline-post.sh\" ]; then \"$ROOT/.claude/hooks/coding-pipeline-post.sh\"; fi || true'"
          }
        ]
      },
      {
        "matcher": "Task",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/post-task.sh\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; \"$ROOT/.claude/hooks/post-task.sh\" || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -f \"$ROOT/scripts/hooks/ucm-post-task-archive.ts\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; npx tsx \"$ROOT/scripts/hooks/ucm-post-task-archive.ts\" || true'"
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; cat | jq -r \".tool_input.command // empty\" | tr \"\\n\" \"\\0\" | xargs -0 -I {} npx claude-flow@alpha hooks post-command --command \"{}\" --track-metrics true --store-results true || true'"
          }
        ]
      },
      {
        "matcher": "Write|Edit|MultiEdit",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; cat | jq -r \".tool_input.file_path // .tool_input.path // empty\" | tr \"\\n\" \"\\0\" | xargs -0 -I {} npx claude-flow@alpha hooks post-edit --file \"{}\" --format true --update-memory true || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; FILE=$(cat | jq -r \".tool_input.file_path // .tool_input.path // empty\"); [ -n \"$FILE\" ] && [ -x \"$ROOT/.claude/hooks/leann-index-file.sh\" ] && \"$ROOT/.claude/hooks/leann-index-file.sh\" \"$FILE\" || true'"
          }
        ]
      }
    ],
    "PreCompact": [
      {
        "matcher": "manual",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'INPUT=$(cat); CUSTOM=$(echo \"$INPUT\" | jq -r \".custom_instructions // \\\"\\\"\"); echo \"ðŸ”„ PreCompact Guidance:\"; echo \"ðŸ“‹ IMPORTANT: Review CLAUDE.md in project root for:\"; echo \"   â€¢ 54 available agents and concurrent usage patterns\"; echo \"   â€¢ Swarm coordination strategies (hierarchical, mesh, adaptive)\"; echo \"   â€¢ SPARC methodology workflows with batchtools optimization\"; echo \"   â€¢ Critical concurrent execution rules (GOLDEN RULE: 1 MESSAGE = ALL OPERATIONS)\"; if [ -n \"$CUSTOM\" ]; then echo \"ðŸŽ¯ Custom compact instructions: $CUSTOM\"; fi; echo \"âœ… Ready for compact operation\"'"
          }
        ]
      },
      {
        "matcher": "auto",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'echo \"ðŸ”„ Auto-Compact Guidance (Context Window Full):\"; echo \"ðŸ“‹ CRITICAL: Before compacting, ensure you understand:\"; echo \"   â€¢ All 54 agents available in .claude/agents/ directory\"; echo \"   â€¢ Concurrent execution patterns from CLAUDE.md\"; echo \"   â€¢ Batchtools optimization for 300% performance gains\"; echo \"   â€¢ Swarm coordination strategies for complex tasks\"; echo \"âš¡ Apply GOLDEN RULE: Always batch operations in single messages\"; echo \"âœ… Auto-compact proceeding with full agent context\"'"
          }
        ]
      }
    ],
    "PermissionRequest": [
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'INPUT=$(cat); CMD=$(echo \"$INPUT\" | jq -r \".tool_input.command // empty\" 2>/dev/null); TOOL=$(echo \"$INPUT\" | jq -r \".tool_name // empty\" 2>/dev/null); if [ \"$TOOL\" = \"Bash\" ] && [ -n \"$CMD\" ]; then TRIMMED=$(echo \"$CMD\" | grep -m1 \"[^[:space:]]\" | sed \"s/^[[:space:]]*//\"); case \"$TRIMMED\" in cd\\ *|npx\\ *|python*|node\\ *|npm\\ *|git\\ *|wc\\ *|tail\\ *|head\\ *|ls\\ *|ls|grep\\ *|cat\\ *|test\\ *|sleep\\ *|kill\\ *|jq\\ *|which\\ *|pwd|sed\\ *|awk\\ *|mkdir\\ *|timeout\\ *) echo \"{\\\"decision\\\": \\\"allow\\\"}\"; exit 0;; esac; fi'"
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null); [ -n \"$ROOT\" ] && rm -f \"$ROOT/.claude/runtime/.god-code-active\" 2>/dev/null; echo \"ðŸ”“ God-code pipeline mode cleared\"; [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; npx claude-flow@alpha hooks session-end --generate-summary true --persist-state true --export-metrics true || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/god-agent-save.sh\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; \"$ROOT/.claude/hooks/god-agent-save.sh\" || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -f \"$ROOT/scripts/hooks/ucm-session-start.ts\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; npx tsx \"$ROOT/scripts/hooks/ucm-session-start.ts\" --action=stop || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -f \"$ROOT/scripts/hooks/leann-process-queue.ts\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; echo \"[LEANN] Processing index queue...\"; timeout 120 npx tsx \"$ROOT/scripts/hooks/leann-process-queue.ts\" 2>/dev/null || echo \"[LEANN] Queue processing skipped or timed out\"'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/clean-settings.sh\" ] && \"$ROOT/.claude/hooks/clean-settings.sh\" || true'"
          }
        ]
      }
    ],
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/hooks/clean-settings.sh\" ] && \"$ROOT/.claude/hooks/clean-settings.sh\" || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && [ -f \".swarm/memory.db\" ] && sqlite3 .swarm/memory.db \"DELETE FROM memory_entries WHERE status=\\\"deleted\\\";\" 2>/dev/null && echo \"[memory-fix] Purged ghost entries\" || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; bash scripts/god-agent-start.sh 2>/dev/null || true'"
          },
          {
            "type": "command",
            "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -f \"$ROOT/scripts/hooks/ucm-session-start.ts\" ] && cd \"$ROOT\" && source ~/.profile 2>/dev/null && nvm use 22 --silent 2>/dev/null; npx tsx \"$ROOT/scripts/hooks/ucm-session-start.ts\" 2>/dev/null || true'"
          }
        ]
      }
    ]
  },
  "includeCoAuthoredBy": true,
  "enabledMcpjsonServers": ["claude-flow@alpha", "ruv-swarm", "serena"],
  "statusLine": {
    "type": "command",
    "command": "/bin/bash -c 'ROOT=$(git rev-parse --show-toplevel 2>/dev/null) && [ -n \"$ROOT\" ] && [ -x \"$ROOT/.claude/statusline-command.sh\" ] && \"$ROOT/.claude/statusline-command.sh\" || echo \"\"'"
  }
}
